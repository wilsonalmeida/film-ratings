{:duct.profile/base
 {:duct.core/project-ns film-ratings
  :duct.handler/root {:middleware [#ig/ref :film-ratings.handler.middleware/anti-forgery-field]}
  :duct.router/ataraxy
  {:routes
   {[:get "/"] [:film-ratings.handler.index/index]
    ;; [:get "/"] ^:anti-forgery-token [:film-ratings.handler.index/index]
    [:get  "/add-film"]  [:film-ratings.handler.film/show-create]
    [:post "/add-film" {film-form :form-params}]
    [:film-ratings.handler.film/create film-form]
    ;;    [:post "/edit-film/" id] [:film-ratings.handler.film/edit ^int id]
    [:delete "/film/" name] [:film-ratings.handler.film/destroy name]
    [:get "/list-films"]  [:film-ratings.handler.film/list]}
   ;; :middleware {:anti-forgery-token
   ;;              #ig/ref :film-ratings.handler.middleware/anti-forgery-field}
   }

  :film-ratings.handler.middleware/anti-forgery-field {}
  :film-ratings.handler.index/index  {}
  :film-ratings.handler.film/show-create {}
  :film-ratings.handler.film/create {:db #ig/ref :duct.database/sql}
  :film-ratings.handler.film/list {:db #ig/ref :duct.database/sql}
  ;; :film-ratings.handler.film/edit-film {:db #ig/ref :duct.database/sql}
  :film-ratings.handler.film/destroy {:db #ig/ref :duct.database/sql}

  :duct.migrator/ragtime
  {:migrations [#ig/ref :film-ratings.migrations/create-film]}

  [:duct.migrator.ragtime/sql :film-ratings.migrations/create-film]
  {:up ["CREATE TABLE film (id INTEGER PRIMARY KEY, name TEXT UNIQUE,
  description TEXT, rating INTEGER)"]
   :down ["DROP TABLE film"]
   }
  ;; Disable anti-forgery check for testing from command line httpie
  ;; :duct.middleware.web/defaults {:security {:anti-forgery false}}
  ;; :duct.middleware.web/defaults {:static {:resources ["film_ratings/resources/film_ratings/public"]}}
  }

 :duct.profile/dev   #duct/include "dev"
 :duct.profile/local #duct/include "local"
 :duct.profile/prod  {}

 :duct.module/logging {}

 ;; :duct.module.web/api {}
 :duct.module.web/site {}

 :duct.module/sql {}
 :duct.module/shadow-cljs
 {:source-paths  ["src"]
  :dev-http {8000 "resources/film_ratings/public"}
  :nrepl {:port 9000}
  :builds {:app {:target :browser
                 :output-to "resources/film_ratings/public/js/main.js"
                 :output-dir "resources/film_ratings/public/js"
                 ;; :asset-path "/js"
                 :modules {:main {:entries [film-ratings.client]
                                  :init-fn film-ratings.client/main}}
                 :optimizations :none}}}
 }
